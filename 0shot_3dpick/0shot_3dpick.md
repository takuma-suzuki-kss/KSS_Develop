# アノテーションコスト削減を目的とした0-shotセグメンテーションの実用性評価：製造現場における基盤モデルの比較

## ① 背景

京都製作所では、3DセンサとAIを組み合わせたピッキングシステム（以下3DPick）を開発した。
3DPickは、AIによるインスタンスセグメンテーションとルールベース処理を併用し、社内評価および実機テストでほぼ100％のピッキング精度を実現している。

一方で、3DPickで使用しているHALCONのセグメンテーションモデルは教師あり学習であり、以下の運用上の課題がある

- 学習データのアノテーション作業には多大な時間とコストがかかる
- 作業者によるアノテーションの品質差がマスク精度に影響する
- 学習のたびにマスク境界精度にバラツキが生じる

これら課題に対し、ゼロショットセグメンテーション（学習していない物体を正確にマスクすること）を可能とする基盤モデルが注目されている。  
例えば、Meta社のSegment Anything Model（SAM）は、プロンプト（位置座標）に基づき、大規模な事前学習済みデータを活用し、追加学習なしで任意の物体をマスクできるため、アノテーションコスト削減と柔軟な運用が期待される。

---

## ② 目的

本研究では、3DPickの運用課題を解決するために、SAMを起点に複数の基盤モデルを比較検証し、製造現場での実運用に適したモデル選定の指針を得ることである。
評価観点と目標は以下の通り
- アノテーション作業の削減　→　0時間（アノテーションを不要とする）
- セグメンテーション精度　　→　現行の3DPickと同程度
- モデルの推論速度　　　　　→　200ms以内（現行の3DPickの参考値）

対象モデルは、SAM、GroundingDINO、nanoSAMとし、詳細は3.2モデル構成にて記載する

---

## ③ 評価環境と方法

### 3.1 データセット

3DPickの以下の案件データで使用したRGB-D画像を用いる。
- Q578：AGF味の素
- Q441：銀座コージコーナー
- Q585：旭化成メディカル

これらは、画像サイズに対するワークサイズが小、中、大と異なり、モデルの汎化性能やサイズ依存性を評価に適しているため選定した。

### 3.2 モデル構成

ゼロショットセグメンテーションが可能で、商用利用が許可されている以下の3つの基盤モデルを比較対象とする（以下のモデルでの実験想定だが、調査中）

- **SAM**：Meta社が開発モデル。座標プロンプトに基づき、対象物のマスクを出力
- **GroundingDINO**：テキストプロンプトにより物体を検出し、マスクを出力
- **nanoSAM**：SAMを軽量化したモデルで、推論速度とリソース効率に優れる

<div style="page-break-before:always"></div>

---

### 3.3 評価指標

- **IoU（Intersection over Union）**：セグメンテーションマスクの重なり具合を評価。
- **アノテーション削減率**：従来の手動アノテーションと比較した削減割合。
- **推論時間**：1画像あたりの平均処理時間。

### 3.4 実験手順

1. 各モデルに対して、同一のデータセットを用いてセグメンテーションを実行。
2. 出力マスクをGround Truthと比較し、IoUおよびmAPを算出。
3. 推論時間を測定し、リアルタイム性を評価。
4. アノテーション作業時間を記録し、削減効果を算出。

## ④ 結果

Q578：AGF味の素
| モデル       | IoU   | mAP   | 推論時間（秒） | アノテーション削減率 |
|--------------|--------|--------|----------------|------------------|
| SAM          | *.**   | *.**   | *.**           | ***%             |
| GroundingDINO| *.**   | *.**   | *.**           | ***%             |
| nanoSAM      | *.**   | *.**   | *.**           | ***%              |
| Mask R-CNN（従来）| 0.84   | 0.80   | 0.50           |                |


Q441：銀座コージコーナー
| モデル       | IoU   | mAP   | 推論時間（秒） | アノテーション削減率 |
|--------------|--------|--------|----------------|------------------|
| SAM          | *.**   | *.**   | *.**           | ***%             |
| GroundingDINO| *.**   | *.**   | *.**           | ***%             |
| nanoSAM      | *.**   | *.**   | *.**           | ***%              |
| Mask R-CNN（従来）| 0.84   | 0.80   | 0.50           | 0%               |

Q585：旭化成メディカル
| モデル       | IoU   | mAP   | 推論時間（秒） | アノテーション削減率 |
|--------------|--------|--------|----------------|------------------|
| SAM          | *.**   | *.**   | *.**           | ***%             |
| GroundingDINO| *.**   | *.**   | *.**           | ***%             |
| nanoSAM      | *.**   | *.**   | *.**           | ***%              |
| Mask R-CNN（従来）| 0.84   | 0.80   | 0.50           | 0%               |


- nanoSAMは最も高速な推論を実現した。
- SAMはバランスの取れた性能を示し、
- GroundingDINOはテキストプロンプトによる柔軟な操作性→ただし、テキストプロンプトの指定したものがないと誤検出が発生。


## ⑤ 考察


## ⑥ 結論




